10 SCREEN 0 : COLOR 7, 0 : CLS
20 DIM BOARD(9,19), PIECES(6,3,3)
30 RANDOMIZE
40 REM Define Tetromino Shapes
50 DATA 1,1,1,1,0,0,0,0,0,0,0,0  : REM I-shape
60 DATA 1,1,1,0,0,1,0,0,0,0,0,0  : REM T-shape
70 DATA 1,1,0,0,0,1,1,0,0,0,0,0  : REM S-shape
80 DATA 0,1,1,0,1,1,0,0,0,0,0,0  : REM Z-shape
90 DATA 1,1,0,0,1,0,0,0,1,0,0,0  : REM L-shape
100 DATA 0,1,0,0,0,1,0,0,1,1,0,0 : REM J-shape
110 DATA 1,1,0,0,1,1,0,0,0,0,0,0 : REM O-shape
120 FOR P=0 TO 6: FOR I=0 TO 2: FOR J=0 TO 2: READ PIECES(P,I,J): NEXT:NEXT:NEXT
130 REM Game Initialization
140 X=4: Y=0: CP=INT(RND(1)*7)
150 GAMEOVER=0
160 GOSUB 500 : REM Draw Board
170 REM Game Loop
180 IF GAMEOVER=1 THEN PRINT "GAME OVER!": END
190 GOSUB 600 : REM Draw Current Piece
200 GOSUB 800 : REM Check Collision for Down
210 IF COLLISION=0 THEN Y=Y+1 ELSE GOSUB 700 : REM Place Piece
220 GOSUB 500 : REM Draw Board
230 REM Controls
240 K$=INKEY$
250 IF K$="Z" THEN GOSUB 810: IF COLLISION=0 THEN X=X-1 : REM Move Left
260 IF K$="X" THEN GOSUB 820: IF COLLISION=0 THEN X=X+1 : REM Move Right
270 IF K$=" " THEN CP=(CP+1) MOD 7 : REM Rotate (basic)
280 GOTO 180
290 REM Drawing the Board
500 CLS
510 FOR J=0 TO 19
520 FOR I=0 TO 9
530 IF BOARD(I,J)=1 THEN PRINT CHR$(219); ELSE PRINT ".";
540 NEXT I : PRINT
550 NEXT J
560 RETURN
570 REM Draw the Current Piece
600 FOR I=0 TO 2
610 FOR J=0 TO 2
620 IF PIECES(CP,I,J)=1 THEN LOCATE X+I,Y+J: PRINT CHR$(219);
630 NEXT J 
635 NEXT I
640 RETURN
650 REM Check Collision for Down
800 COLLISION=0
810 FOR I=0 TO 2
820 FOR J=0 TO 2
830 IF PIECES(CP,I,J)=1 THEN
840   IF Y+J>=19 OR BOARD(X+I,Y+J+1)=1 THEN COLLISION=1
850 END IF
860 NEXT J
865 NEXT I
870 RETURN
880 REM Check Collision for Left
810 COLLISION=0
820 FOR I=0 TO 2
830 FOR J=0 TO 2
840 IF PIECES(CP,I,J)=1 THEN
850   IF X+I<=0 OR BOARD(X+I-1,Y+J)=1 THEN COLLISION=1
860 END IF
870 NEXT J : NEXT I
880 RETURN
890 REM Check Collision for Right
820 COLLISION=0
830 FOR I=0 TO 2
840 FOR J=0 TO 2
850 IF PIECES(CP,I,J)=1 THEN
860   IF X+I>=9 OR BOARD(X+I+1,Y+J)=1 THEN COLLISION=1
870 END IF
880 NEXT J : NEXT I
890 RETURN
900 REM Place Piece
700 FOR I=0 TO 2
710 FOR J=0 TO 2
720 IF PIECES(CP,I,J)=1 THEN BOARD(X+I,Y+J)=1
730 NEXT J : NEXT I
740 REM Check for Line Completion
750 FOR J=0 TO 19
760 COMPLETE=1
770 FOR I=0 TO 9
780 IF BOARD(I,J)=0 THEN COMPLETE=0
790 NEXT I
800 IF COMPLETE=1 THEN FOR Y1=J TO 1 STEP -1: FOR I=0 TO 9: BOARD(I,Y1)=BOARD(I,Y1-1): NEXT:NEXT
810 NEXT J
820 X=4: Y=0: CP=INT(RND*7)
830 GOSUB 800 : REM Check if new piece can be placed
840 IF COLLISION=1 THEN GAMEOVER=1
850 RETURN
